<div class="expansion-panel">
    <mat-accordion>
        <mat-expansion-panel>

            <!-- Panel Header -->
            <mat-expansion-panel-header>

                <!-- Panel Title -->
                <mat-panel-title>
                    Filter Options
                </mat-panel-title>

                <!-- Panel Description -->
                <mat-panel-description>

                    <!-- Settings Icon -->
                    <mat-icon>filter_alt</mat-icon>

                    <!-- Filters Applied -->
                    <span *ngIf="filterText">
                        {{ filterText }}
                    </span>

                    <!-- Message to be shown on the panel -->
                    <span *ngIf="message" class="message" [innerHtml]="message | safeHtml"></span>

                </mat-panel-description>

            </mat-expansion-panel-header>

            <!-- Filters -->
            <form>

                <!-- Misc Filters -->
                <fieldset class="field_set">

                    <legend>
                        Misc Filters
                    </legend>

                    <div class="filter-container">

                        <!-- Org ID -->
                        <mat-form-field>
                            <mat-label>Organisation ID</mat-label>
                            <input matInput [formControl]="filterFormControls.organisationId" placeholder="e.g. Y00082" (input)="onOrganisationIdInput($event)">
                            <button *ngIf="filterFormControls.organisationId.value" matSuffix mat-icon-button aria-label="Clear" (click)="filterFormControls.organisationId.setValue(null)" tabindex="-1">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>

                        <!-- Name -->
                        <mat-form-field>
                            <mat-label>Organisation Name</mat-label>
                            <input matInput [formControl]="filterFormControls.name" placeholder="e.g. Medical Practice">
                            <button *ngIf="filterFormControls.name.value" matSuffix mat-icon-button aria-label="Clear" (click)="filterFormControls.name.setValue(null)" tabindex="-1">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>

                        <!-- Status -->
                        <mat-form-field>
                            <mat-label>Status</mat-label>
                            <mat-select [formControl]="filterFormControls.status" placeholder="Select a status">
                                <mat-option [value]="null"></mat-option>
                                <mat-option *ngFor="let s of status" [value]="s.id">
                                    {{ s.displayName }}
                                </mat-option>
                            </mat-select>
                            <button *ngIf="filterFormControls.status.value" matSuffix mat-icon-button aria-label="Clear"
                                (click)="filterFormControls.status.setValue(null)">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>

                        <!-- Primary Role -->
                        <shared-role-select
                            [control]="filterFormControls.primaryRoles"
                        ></shared-role-select>

                        <!-- Last Change Date -->
                        <mat-form-field>
                            <mat-label>Last Changed After</mat-label>
                            <input matInput [matDatepicker]="picker" [formControl]="filterFormControls.lastChangeDate" [max]="maxDate">
                            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                            <button *ngIf="filterFormControls.lastChangeDate.value" matSuffix mat-icon-button aria-label="Clear" (click)="filterFormControls.lastChangeDate.setValue(null)">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>

                        <div class="filter-spacer">

                        </div>

                    </div>

                </fieldset>

                <div class="spacer"></div>

                <!-- Postcode Filters -->
                <fieldset class="field_set">

                    <legend>
                        Postcode Filters
                    </legend>

                    <div class="filter-container">

                        <!-- Postcode -->
                        <mat-form-field>
                            <mat-label>Postcode</mat-label>
                            <input matInput [formControl]="filterFormControls.postcode" placeholder="e.g. DA14" (input)="onPostcodeInput($event)">
                            <button *ngIf="filterFormControls.postcode.value" matSuffix mat-icon-button aria-label="Clear" (click)="filterFormControls.postcode.setValue(null)" tabindex="-1">
                                <mat-icon>close</mat-icon>
                            </button>
                        </mat-form-field>

                        <!-- Admin County -->
                        <shared-select
                            label="Admin County"
                            [fControl]="filterFormControls.adminCounty"
                            [data]="(adminCounty$ | async) || []"
                        ></shared-select>

                        <!-- Admin District -->
                        <shared-select
                            label="Admin District"
                            [fControl]="filterFormControls.adminDistrict"
                            [data]="(adminDistrict$ | async) || []"
                        ></shared-select>

                        <!-- Parliamentary Constituency -->
                        <shared-select
                            label="Parliamentary Constituency"
                            [fControl]="filterFormControls.parliamentaryConstituency"
                            [data]="(parliamentaryConstituency$ | async) || []"
                        ></shared-select>

                        <!-- Police Force Area -->
                        <shared-select
                            label="Police Force Area"
                            [fControl]="filterFormControls.policeForceArea"
                            [data]="(policeForceArea$ | async) || []"
                        ></shared-select>

                        <!-- Nuts -->
                        <shared-select
                            label="NUTS"
                            [fControl]="filterFormControls.nuts"
                            [data]="(nuts$ | async) || []"
                        ></shared-select>

                        <!-- Postcode Area -->
                        <shared-select
                            label="Postcode Area"
                            [fControl]="filterFormControls.postcodeArea"
                            [data]="(postcodeArea$ | async) || []"
                        ></shared-select>

                        <!-- European Electoral Region -->
                        <shared-select
                            label="European Electoral Region"
                            [fControl]="filterFormControls.europeanElectoralRegion"
                            [data]="(europeanElectoralRegion$ | async) || []"
                        ></shared-select>

                        <!-- Health Authority -->
                        <shared-select
                            label="Health Authority"
                            [fControl]="filterFormControls.healthAuthority"
                            [data]="(healthAuthority$ | async) || []"
                        ></shared-select>

                        <!-- Primary Care Trust -->
                        <shared-select
                            label="Primary Care Trust"
                            [fControl]="filterFormControls.primaryCareTrust"
                            [data]="(primaryCareTrust$ | async) || []"
                        ></shared-select>

                        <!-- Region -->
                        <shared-select
                            label="Region"
                            [fControl]="filterFormControls.region"
                            [data]="(region$ | async) || []"
                        ></shared-select>

                        <!-- Country -->
                        <shared-select
                            label="Country"
                            [fControl]="filterFormControls.country"
                            [data]="(country$ | async) || []"
                        ></shared-select>

                    </div>

                </fieldset>

            </form>

        </mat-expansion-panel>

    </mat-accordion>

</div>
